import{w as N,r as a,j as e,t as Q,S as H,O as J,ag as $,T as z,C as Y,ah as l,Z as y,$ as Z,a0 as K,a2 as U,ai as v,aj as V,Y as m,ap as X,aq as f,B as ee,L as te,y as se,a3 as ae,M as ne,N as le,A as b,Q as C,W as oe}from"./index-019ce5a6.js";import"./table-head-98595357.js";import"./approve-dialog-1c59e89c.js";import{R as ie,a as k}from"./RadioGroup-8a0afae4.js";const re=()=>{const P=N(),[R,L]=a.useState([]),[h,w]=a.useState([]),[p,I]=a.useState(null),[A,T]=a.useState(null),[i,S]=a.useState(""),[r,_]=a.useState(""),[d,q]=a.useState(""),[c,E]=a.useState(""),[u,F]=a.useState(""),[g,B]=a.useState(""),[O,x]=a.useState(!1),[s,D]=a.useState(),G=async()=>{var o;const t=await b.GetProductList(),n=await b.GetShopList();L((o=t==null?void 0:t.data)==null?void 0:o.filter(j=>(j==null?void 0:j.is_stock_control)==1)),w(n==null?void 0:n.data)},W=async t=>{t.preventDefault(),x(!0);const n={shop_id:i,product_id:r.id,qty:d,type:c,responsible_person:u,reason:g};if(r&&i&&d&&u&&c){const o=await b.CreateStockAdjustment(n);o.code===200?(C.success(o.message,{theme:"colored"}),setTimeout(()=>P("/stock-adjustments"),2e3)):(x(!1),C.error(o.message))}else D({shop:i==="",product:r==="",qty:d==="",responsiblePerson:u==="",type:c===""}),x(!1)},M=()=>{const t=JSON.parse(localStorage.getItem("user"));I(t==null?void 0:t.role_id),T(t==null?void 0:t.shop_id)};return a.useEffect(()=>{p!==1&&h.length>0&&S(A||"")},[p,h]),a.useEffect(()=>{G(),M()},[]),e.jsxs(Q,{maxWidth:"xl",children:[e.jsx(H,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsxs(J,{"aria-label":"breadcrumb",children:[e.jsx($,{variant:"h4",underline:"hover",color:"inherit",href:"/stock-adjustments",children:"Stock Adjustment Management"}),e.jsx(z,{variant:"h4",children:"Create Stock Adjustment"})]})}),e.jsx(Y,{sx:{padding:"1rem",minHeight:"50vh"},children:e.jsxs("form",{onSubmit:W,children:[e.jsxs(l,{container:!0,spacing:2,children:[e.jsx(l,{item:!0,xs:6,md:6,sm:12,children:e.jsxs(y,{fullWidth:!0,error:s==null?void 0:s.shop,children:[e.jsx(Z,{id:"demo-simple-select-label",children:"Shop"}),e.jsx(K,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:i,label:"Shop",inputProps:{readOnly:p!==1},onChange:t=>{S(t.target.value)},children:h.map(t=>e.jsxs(U,{value:t.id,children:[t.name," (",t.shop_code,")"]},t.id))}),e.jsx(v,{children:s!=null&&s.shop?"Select Shop!":" "})]})}),e.jsx(l,{item:!0,xs:6,md:6,sm:12,children:e.jsx(V,{freeSolo:!0,id:"product-list",value:r||null,options:R.map(t=>({label:t.product_name,id:t.id})),onChange:(t,n)=>_(n),renderInput:t=>e.jsx(m,{...t,label:"Products",error:s==null?void 0:s.product,helperText:s!=null&&s.product?"Add Product!":""})})}),e.jsx(l,{item:!0,xs:6,md:6,sm:12,children:e.jsx(m,{id:"qty",label:"Quantity",type:"number",value:d??"",onChange:t=>q(t.target.value),sx:{width:"100%"},error:s==null?void 0:s.qty,helperText:s!=null&&s.qty?"Enter qty":""})}),e.jsx(l,{item:!0,xs:6,md:6,sm:12,children:e.jsxs(y,{fullWidth:!0,error:s==null?void 0:s.type,children:[e.jsx(X,{id:"type-label",children:"Type"}),e.jsxs(ie,{row:!0,"aria-labelledby":"type-label",name:"type",value:c,onChange:t=>{E(t.target.value)},children:[e.jsx(f,{value:"+",control:e.jsx(k,{}),label:"+"}),e.jsx(f,{value:"-",control:e.jsx(k,{}),label:"-"})]}),e.jsx(v,{children:s!=null&&s.type?"Select type!":" "})]})}),e.jsx(l,{item:!0,xs:6,md:6,sm:12,children:e.jsx(m,{id:"responsible-person",label:"Responsible Person",value:u??"",onChange:t=>F(t.target.value),sx:{width:"100%"},error:s==null?void 0:s.responsiblePerson,helperText:s!=null&&s.responsiblePerson?"Enter responsible person":""})}),e.jsx(l,{item:!0,xs:6,md:6,sm:12,children:e.jsx(m,{id:"reason",label:"Reason",value:g??"",onChange:t=>B(t.target.value),sx:{width:"100%"},multiline:!0})})]}),e.jsxs(ee,{sx:{pb:3,display:"flex",mt:2,float:"right"},children:[e.jsx(te,{underline:"hover",color:"primary",to:"/stock-adjustments",children:e.jsx(se,{variant:"outlined",color:"primary",sx:{borderRadius:1,marginRight:1},children:"Cancel"})}),e.jsx(ae,{type:"submit",size:"medium",variant:"contained",sx:{borderRadius:1},loading:O,children:"Create"})]})]})}),e.jsx(ne,{position:le,autoClose:1500})]})},he=()=>e.jsxs(e.Fragment,{children:[e.jsx(oe,{children:e.jsx("title",{children:" Juvenus POS | Stock Adjustment "})}),e.jsx(re,{})]});export{he as default};
