import{w as tt,x as et,r as s,j as l,T as at,C as nt,aR as st,z as lt,D as ot,E as it,F as rt,aS as ct,G as ut,aT as dt,H as mt,J as gt,K as St,M as _t,N as ht,A as c,Q as w,W as ft}from"./index-019ce5a6.js";import{C as xt,S as Dt}from"./Stack-4cf92a60.js";function Ct(){const d=tt(),[D]=et();D.get("page"),D.get("keyword"),s.useState([]);const[h,m]=s.useState(null),[C,v]=s.useState(!0),[p,pt]=s.useState(""),[F,f]=s.useState(!1),[jt,P]=s.useState(!1),[G,j]=s.useState(""),[k,b]=s.useState(!1),[A,N]=s.useState(null),[bt,R]=s.useState(null),[y,yt]=s.useState(null);s.useState(null);const[T,g]=s.useState([]),[u,O]=s.useState(null),[r,E]=s.useState(new Date().toISOString().slice(0,10)),[i,$]=s.useState(new Date().toISOString().slice(0,10)),[S,L]=s.useState(null),[W,B]=s.useState([]),[H,J]=s.useState([]),[x,V]=s.useState(null),I=async()=>{var a,e;const t=await c.GetSettlementLists();g((a=t==null?void 0:t.data)==null?void 0:a.data),m((e=t==null?void 0:t.data)==null?void 0:e.pagination),v(!1)},q=async()=>{const t=await c.GetCustomerLists();B(t==null?void 0:t.data)},z=async()=>{const t=await c.GetTransactionIdLists();J(t==null?void 0:t.data)};s.useEffect(()=>{I(),q(),z()},[]);const K=async(t,a)=>{var n,o;O(a),d(`/customer/settlement/list?page=${a===null?"":a}&from_date=${y===null?"":y}&to_date=${i===null?"":i}&counter_id=${S===null?"":S}`);const e=await c.GetSettlementLists(a);g((n=e==null?void 0:e.data)==null?void 0:n.data),m((o=e==null?void 0:e.data)==null?void 0:o.pagination)},M=async t=>{var n,o;const a=t.target.value;E(a),d(`/customer/settlement/list?page=${u===null?"":u}&from_date=${a===null?"":a}&to_date=${i===null?"":i}&counter_id=${S===null?"":S}`);const e=await c.GetSettlementLists("",a,"","");g((n=e==null?void 0:e.data)==null?void 0:n.data),m((o=e==null?void 0:e.data)==null?void 0:o.pagination)},Q=async t=>{var n,o;const a=t.target.value;$($),d(`/customer/settlement/list?page=${u===null?"":u}&from_date=${r===null?"":r}&to_date=${a===null?"":a}&counter_id=${S===null?"":S}`);const e=await c.GetSettlementLists("",r,a,"");g((n=e==null?void 0:e.data)==null?void 0:n.data),m((o=e==null?void 0:e.data)==null?void 0:o.pagination)},U=async(t,a)=>{var o,_;V(a.id);const e=a.id;j(e),L(e),d(`/customer/settlement/list?page=${u===null?"":u}&from_date=${r===null?"":r}&to_date=${i===null?"":i}&customer_id=${x===null?"":x}&transaction_id=${e===null?"":e}`);const n=await c.GetSettlementLists("",r,i,e);g((o=n==null?void 0:n.data)==null?void 0:o.data),m((_=n==null?void 0:n.data)==null?void 0:_.pagination)},X=async(t,a)=>{var o,_;const e=a.transaction_id;j(e),L(e),d(`/customer/settlement/list?page=${u===null?"":u}&from_date=${r===null?"":r}&to_date=${i===null?"":i}&customer_id=${e===null?"":e}`);const n=await c.GetSettlementLists("",r,i,x,e);g((o=n==null?void 0:n.data)==null?void 0:o.data),m((_=n==null?void 0:n.data)==null?void 0:_.pagination)},Y=async()=>{d("/customer/settlement/list"),window.location.reload()},Z=async()=>{f(!1),b(!0);const t=await c.DeleteSettlement(A);t.code===200?(b(!1),w.success(t.message,{theme:"colored"}),setTimeout(()=>I(),2e3)):w.error(t.message)};return l.jsxs(xt,{maxWidth:"xl",children:[l.jsx(Dt,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:l.jsx(at,{variant:"h4",children:"Customer Settlement"})}),l.jsxs(nt,{children:[l.jsx(st,{fromCurrentDate:r,toCurrentDate:i,filterName:p,filterStatus:G,onFilterFromDate:M,onFilterToDate:Q,onFilterStatus:U,handleClear:Y,customer:W,transactionIds:H,onFilterTransactionStatus:X}),C&&l.jsx(lt,{color:"secondary"}),l.jsx(ot,{children:l.jsx(it,{sx:{overflow:"unset"},children:l.jsxs(rt,{sx:{minWidth:1e3},children:[l.jsx(ct,{headLabel:[{id:"id",label:"No",align:"center"},{id:"voucher",label:"TransactionId",align:"center"},{id:"settlement_amount",label:"Settlement Amount",align:"center"},{id:"remaining_amount",label:"Remaining Amount",align:"center"},{id:"user_package_id",label:"Package",align:"center"},{id:"type",label:"Type",align:"center"},{id:"customer_id",label:"Customer",align:"center"},{id:"created_at",label:"Date",align:"center"},{id:"action",label:"Action",align:"center"}]}),l.jsx(ut,{children:T?T.map((t,a)=>l.jsx(dt,{no:t.id,id:a+1,voucher:t.voucher,settlement_amount:t.settlement_amount,remaining_amount:t.remaining_amount,user_package_id:t.user_package_id,customer_id:t.customer_id,type:t.type,counter_id:t.counter_id,created_at:t.created_at,setOpenDialog:f,setOpenApproveDialog:P,setDeleteId:N,setUpdateId:R},t.id)):!C&&l.jsx(mt,{query:p})})]})})}),h&&l.jsx(gt,{sx:{float:"right"},count:h.total_page,page:h.page,onChange:K})]}),l.jsx(St,{openDialog:F,setOpenDialog:f,handleDelete:Z,disabled:k}),l.jsx(_t,{position:ht,autoClose:1500})]})}function Lt(){return l.jsxs(l.Fragment,{children:[l.jsx(ft,{children:l.jsx("title",{children:" Juvenus POS | Settlement List "})}),l.jsx(Ct,{})]})}export{Lt as default};
