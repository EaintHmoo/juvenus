import{j as e,aB as oe,aC as ce,aD as de,y as W,P as t,am as ue,aa as Q,ab as k,ao as ge,w as Y,aJ as me,r as c,V as he,aK as n,ac as J,I as w,ad as xe,a2 as v,a6 as pe,B as K,a7 as Ce,a8 as je,Z as M,aj as fe,Y as ye,a0 as be,a9 as ke,x as Pe,T as Se,C as we,z as _e,D as Te,E as De,F as ve,G as Ie,H as Oe,J as Le,K as Ae,M as Fe,N as Ne,A as b,Q as N,W as Be}from"./index-019ce5a6.js";import{C as $e,S as qe}from"./Stack-4cf92a60.js";function V({openCancelDialog:g,setOpenCancelDialog:i,handleCancel:f,disabled:d}){return e.jsxs(oe,{open:g,onClose:()=>i(!1),"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[e.jsx(ce,{id:"alert-dialog-title",children:"Are you sure to cancel this item ?"}),e.jsxs(de,{children:[e.jsx(W,{onClick:()=>i(!1),variant:"outlined",children:"Cancel"}),e.jsx(W,{onClick:f,color:"error",variant:"contained",disabled:d,children:d?"Canceling":"Yes"})]})]})}V.propTypes={openCancelDialog:t.bool,setOpenCancelDialog:t.func,handleCancel:t.func,disabled:t.bool};function Z({headLabel:g}){return e.jsx(ue,{children:e.jsx(Q,{children:g.map(i=>e.jsx(k,{align:i.align||"left",sx:{width:i.width,minWidth:i.minWidth},children:e.jsx(ge,{hideSortIcon:!0,children:i.label})},i.id))})})}Z.propTypes={headLabel:t.array};function X({no:g,id:i,owner_name:f,owner_id:d,pos_treatment_id:P,pos_treatment_name:m,transaction_id:x,total_qty:p,used_qty:l,status:r,setOpenDialog:y,setOpenCancelDialog:B,setDeleteId:L,setUpdateId:A,handleCancel:$,handleDelete:R,customer_package_id:ae}){const F=Y(),C=me(),[S,_]=c.useState(!1);c.useState(!1);const I=j=>{_(j.currentTarget)},q=()=>{F("/offset/create",{state:{owner_id:d,pos_treatment_name:m,transaction_id:x}})},E=()=>{F("/customer/packages/share",{state:{owner_id:d,pos_treatment_name:m,transaction_id:x,pos_treatment_id:P}})},T=j=>{switch(j){case n.Ongoing:return C.palette.info.main;case n.Complete:return C.palette.success.main;case n.Cancel:return C.palette.error.main;case n.Shared:return C.palette.info.main;case n.Delete:return C.palette.error.dark;case n.Active:return C.palette.warning.main;default:return C.palette.grey[500]}},G=j=>{switch(j){case n.Ongoing:return"Ongoing";case n.Complete:return"Complete";case n.Cancel:return"Cancel";case n.Shared:return"Ongoing";case n.Delete:return"Delete";case n.Active:return"Active";default:return"-"}},D=()=>{_(!1),y(!0),L(x)},U=()=>{_(!1),B(!0),L(x)};return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{hover:!0,tabIndex:-1,role:"checkbox",children:[e.jsx(k,{align:"center",children:i}),e.jsx(k,{align:"center",children:f??"-"}),e.jsx(k,{align:"center",children:m??"-"}),e.jsx(k,{align:"center",children:p??"-"}),e.jsx(k,{align:"center",children:l??"-"}),e.jsx(k,{align:"center",children:e.jsx(he,{label:G(r),sx:{backgroundColor:T(r),color:"white",fontWeight:"bold"}})}),e.jsx(k,{align:"right",children:r===n.Complete||r===n.Cancel||r===n.Delete?e.jsx(J,{disabled:!0,children:e.jsx(w,{icon:"eva:more-vertical-fill"})}):e.jsx(J,{onClick:I,children:e.jsx(w,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(xe,{open:!!S,anchorEl:S,onClose:()=>_(!1),anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(v,{onClick:q,children:[e.jsx(w,{icon:"eva:edit-fill",sx:{mr:2}}),"Offset"]}),e.jsxs(v,{onClick:E,sx:{mr:2},children:[e.jsx(w,{icon:"ph:eye-bold",sx:{mr:2}}),"Share"]}),r===n.Active?e.jsxs(v,{onClick:()=>D(),sx:{mr:2},children:[e.jsx(w,{icon:"mdi:delete",sx:{mr:2}}),"Delete"]}):e.jsxs(v,{onClick:()=>U(),children:[e.jsx(w,{icon:"mdi:cancel",sx:{mr:2}}),"Cancel"]})]})]})}X.propTypes={no:t.number,id:t.number,pos_treatment_id:t.string,pos_treatment_name:t.string,total_qty:t.string,used_qty:t.string,status:t.string,owner_name:t.string,transaction_id:t.string,owner_id:t.string,setOpenDialog:t.func,setOpenCancelDialog:t.func,setDeleteId:t.func,setUpdateId:t.func,handleCancel:t.func,handleDelete:t.func,customer_package_id:t.string};function ee({filterStatus:g,filterName:i,onFilterName:f,handleClear:d,onFilterStatus:P,customer:m,onFilterByStatus:x}){var p;return e.jsx(pe,{sx:{height:96,display:"flex",justifyContent:"space-between",p:l=>l.spacing(0,1,0,3)},children:e.jsxs(K,{sx:{display:"flex",justifyContent:"space-between",gap:"1rem"},children:[e.jsx(Ce,{value:i,onChange:f,placeholder:"Search ...",startAdornment:e.jsx(je,{position:"start",children:e.jsx(w,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),e.jsx(M,{sx:{width:"150px"},children:e.jsx(fe,{disablePortal:!0,options:m,getOptionLabel:l=>l.name,onChange:(l,r)=>P(l,r),renderInput:l=>e.jsx(ye,{...l,label:"Customer"})})}),e.jsx(M,{sx:{width:"150px"},children:e.jsxs(be,{displayEmpty:!0,value:g||"",onChange:(l,r)=>x(l,r),children:[e.jsx(v,{disabled:!0,value:"",children:e.jsx("em",{children:"Status"})}),(p=Object.entries(n))==null?void 0:p.map(([l,r])=>e.jsx(v,{value:r,children:l},r))]})}),e.jsx(K,{sx:{alignSelf:"center"},children:e.jsx(W,{variant:"outlined",sx:{ml:3},startIcon:e.jsx(ke,{}),onClick:d,children:"Clear"})})]})})}ee.propTypes={filterName:t.string,onFilterName:t.func,handleClear:t.func,filterStatus:t.string,onFilterStatus:t.func,customer:t.any,onFilterByStatus:t.func};function Ee(){const g=Y(),[i]=Pe(),f=i.get("page"),d=i.get("keyword"),[P,m]=c.useState([]),[x,p]=c.useState(null),[l,r]=c.useState(!0),[y,B]=c.useState(""),[L,A]=c.useState(!1),[$,R]=c.useState(null),[ae,F]=c.useState(null),[C,S]=c.useState(!1),[_,I]=c.useState(!1),[q,E]=c.useState([]),[T,G]=c.useState(null),[D,U]=c.useState(null),j=async()=>{var u;const a=await b.GetCustomerPackageList(f,d);m(a==null?void 0:a.data.data),p((u=a==null?void 0:a.data)==null?void 0:u.pagination),r(!1)},te=async()=>{const a=await b.GetCustomerLists(f,d);E(a==null?void 0:a.data)};c.useEffect(()=>{j(),te()},[]);const se=async a=>{var s,h;g(`/customer/packages/list?page=1&keyword=${a.target.value}`),B(a.target.value);const o=await b.GetCustomerPackageListByIdOrName(1,a.target.value);m((s=o==null?void 0:o.data)==null?void 0:s.data),p((h=o==null?void 0:o.data)==null?void 0:h.pagination)},ne=async(a,u)=>{var s,h;g(`/customer/packages/list?page=${u}&keyword=${d===null?"":d}&customer_id=${T===null?"":T}&status=${D===null?"":D}`);const o=await b.GetCustomerPackageList(u,d,T===null?"":T,D===null?"":D);m((s=o==null?void 0:o.data)==null?void 0:s.data),p((h=o==null?void 0:o.data)==null?void 0:h.pagination)};console.log(P);const le=async()=>{g("/customer/packages/list"),window.location.reload()},z=async()=>{I(!1),S(!0);const a=await b.ActionCustomerPackage($,n.Cancel);a.code===200?(S(!1),N.success(a.message,{theme:"colored"}),setTimeout(()=>j(),2e3)):N.error(a.message)},H=async()=>{A(!1),S(!0);const a=await b.ActionCustomerPackage($,n.Delete);console.log(a),a.code===200?(S(!1),N.success(a.message,{theme:"colored"}),setTimeout(()=>j(),2e3)):N.error(a.message)},ie=async(a,u)=>{var h,O;g(`/customer/packages/list?page=1&keyword=${y}&customer_id=${u.id}&status=`),G(u.id);const s=await b.GetCustomerPackageListByIdOrName(1,y,u.id);m((h=s==null?void 0:s.data)==null?void 0:h.data),p((O=s==null?void 0:s.data)==null?void 0:O.pagination)},re=async(a,u)=>{var h,O;g(`/customer/packages/list?page=1&keyword=${y}&customer_id=&status=${a.target.value}`),U(a.target.value);const s=await b.GetCustomerPackageListByIdOrName(1,y,"",a.target.value);m((h=s==null?void 0:s.data)==null?void 0:h.data),p((O=s==null?void 0:s.data)==null?void 0:O.pagination)};return e.jsxs($e,{maxWidth:"xl",children:[e.jsx(qe,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsx(Se,{variant:"h4",children:"Customer Package List"})}),e.jsxs(we,{children:[e.jsx(ee,{filterName:y,onFilterName:se,handleClear:le,customer:q,onFilterStatus:ie,onFilterByStatus:re}),l&&e.jsx(_e,{color:"secondary"}),e.jsx(Te,{children:e.jsx(De,{sx:{overflow:"unset"},children:e.jsxs(ve,{sx:{minWidth:1e3},children:[e.jsx(Z,{headLabel:[{id:"id",label:"No",align:"center"},{id:"owner_name",label:"Customer",align:"center"},{id:"pos_treatment_name",label:"Pos Treatment Name",align:"center"},{id:"total_qty",label:"Total Qty",align:"center"},{id:"used_qty",label:"Used Qty",align:"center"},{id:"status",label:"Status",align:"center"},{id:"action",label:"Action",align:"center"}]}),e.jsx(Ie,{children:P?P.map((a,u)=>e.jsx(X,{no:a.id,id:u+1,owner_id:a.owner_id,owner_name:a.owner_name,pos_treatment_name:a.pos_treatment_name,user_package_id:a.id,transaction_id:a.transaction_id,total_qty:a.total_qty,used_qty:a.used_qty,status:a.status,setOpenDialog:A,setOpenCancelDialog:I,setDeleteId:R,setUpdateId:F,handleCancel:z,handleDelete:H,customer_package_id:a.id,pos_treatment_id:a.pos_treatment_id},a.id)):!l&&e.jsx(Oe,{query:y})})]})})}),x&&e.jsx(Le,{sx:{float:"right"},count:x.total_page,page:x.page,onChange:ne})]}),e.jsx(Ae,{openDialog:L,setOpenDialog:A,handleDelete:H,disabled:C}),e.jsx(V,{openCancelDialog:_,setOpenCancelDialog:I,handleCancel:z,disabled:C}),e.jsx(Fe,{position:Ne,autoClose:1500})]})}function We(){return e.jsxs(e.Fragment,{children:[e.jsx(Be,{children:e.jsx("title",{children:" Juvenus POS | Customer Package List "})}),e.jsx(Ee,{})]})}export{We as default};
