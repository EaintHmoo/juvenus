import{aI as O,w as T,r as s,j as e,t as $,S as G,O as N,L as u,T as c,y as C,C as Q,aP as J,B as d,Z as Y,$ as Z,a0 as q,a2 as z,ah as m,Y as H,ac as K,aQ as U,a3 as V,M as X,N as ee,A as S,Q as b,W as te}from"./index-019ce5a6.js";function ne(){const v=O(),{customer_id:P,no:k,remaining_credit_amount:_}=v.state||{},i=T(),[B,x]=s.useState(!1),[r,h]=s.useState([]),[o,R]=s.useState([]),[j,A]=s.useState({}),[l,D]=s.useState(!0),I=async()=>{try{const t=await S.GetPyamentLists();R(t==null?void 0:t.data)}catch(t){console.error("Failed to fetch payment methods",t)}};s.useEffect(()=>{I()},[]);const L=t=>{const{value:a}=t.target;h(a)},M=(t,a)=>{A(n=>({...n,[t]:a}))},w=t=>{D(!l)},E=async t=>{const a=r.filter(n=>(console.log(n),n!=t));h([...a])},F=async t=>{var g,y,p;t.preventDefault(),x(!0);const a={customer_id:P,outstanding_id:k,payments:r.map(f=>({payment_method_id:f,amount:j[f]||0}))};console.log("payloadIs"),console.log(a);const n=await S.CreateSettlement(a);(g=n==null?void 0:n.data)==null||g.outstanding;const W=(y=n==null?void 0:n.data)==null?void 0:y.transactionRecord;n.code===200?(l&&i(`/settlement/${(p=W[0])==null?void 0:p.settlement_id}/receipt`),b.success(n.message,{theme:"colored"})):(x(!1),b.error(n.message))};return e.jsxs($,{maxWidth:"lg",children:[e.jsxs(G,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsxs(N,{"aria-label":"breadcrumb",children:[e.jsx(u,{to:"/dashboard",children:"Dashboard"}),e.jsx(u,{to:"/customer/outstanding/list",children:"Outstanding"}),e.jsx(u,{onClick:()=>i(-1),children:"Detail"}),e.jsx(c,{color:"text.primary",children:"Settlement"})]}),e.jsx(C,{variant:"contained",color:"primary",onClick:()=>i(-1),children:"Back"})]}),e.jsxs(Q,{children:[e.jsx(J,{sx:{},checked:l,onChange:w,name:"is_print",value:l}),"Print Slip",e.jsxs(d,{sx:{display:"flex",alignItems:"center",p:2},children:[e.jsx(c,{variant:"h4",component:"h1",sx:{marginRight:"30px"},children:"Remaining Credit Amount"}),e.jsx(c,{variant:"h4",color:"textSecondary",sx:{marginRight:"30px"},children:"="}),e.jsx(c,{variant:"h4",color:"textSecondary",children:_})]}),e.jsx(d,{sx:{p:2},children:e.jsxs("form",{onSubmit:F,children:[e.jsxs(Y,{fullWidth:!0,variant:"outlined",sx:{mb:2},children:[e.jsx(Z,{children:"Select Payment Methods"}),e.jsx(q,{multiple:!0,value:r,onChange:L,label:"Select Payment Methods",children:o==null?void 0:o.map(t=>e.jsx(z,{value:t.id,children:t.payment_name},t.id))})]}),r.map(t=>{const a=o.find(n=>n.id===t);return e.jsx(d,{sx:{mb:2},children:e.jsxs(m,{container:!0,spacing:2,sx:{alignItems:"center"},children:[e.jsx(m,{item:!0,xs:2,children:a.payment_name}),e.jsx(m,{item:!0,xs:4,children:e.jsx(H,{fullWidth:!0,label:`Enter amount for ${a==null?void 0:a.payment_name}`,variant:"outlined",sx:{mt:1},value:j[t]||"",onChange:n=>M(t,n.target.value)})}),e.jsx(m,{item:!0,xs:2,children:e.jsx(K,{"aria-label":"delete",onClick:n=>E(a.id),children:e.jsx(U,{})})})]})},t)}),e.jsxs(d,{sx:{display:"flex",justifyContent:"flex-end"},children:[e.jsx(C,{variant:"outlined",color:"primary",sx:{marginRight:1},onClick:()=>i(-1),children:"Cancel"}),e.jsx(V,{type:"submit",variant:"contained",color:"primary",loading:B,children:"Submit"})]})]})})]}),e.jsx(X,{position:ee,autoClose:1500})]})}function se(){return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:e.jsx("title",{children:" Juvenus | Create Settlement "})}),e.jsx(ne,{})]})}export{se as default};
