import{j as e,a6 as V,B as z,a7 as H,a8 as M,I as j,Y as U,y as A,a9 as G,P as n,w as D,r as h,aa as R,ab as d,ac as J,ad as q,a2 as P,am as Y,ao as K,x as Q,t as X,S as Z,T as ee,C as te,z as ae,D as ne,E as se,F as re,G as oe,H as ie,J as le,M as de,N as ce,A as O,W as he}from"./index-019ce5a6.js";function E({filter:a,handleFilter:s,handleClear:g}){return e.jsx(V,{sx:{height:96,display:"flex",justifyContent:"space-between",p:x=>x.spacing(0,1,0,3)},children:e.jsxs(z,{children:[e.jsx(H,{defaultValue:a==null?void 0:a.keyword,onChange:s,name:"keyword",placeholder:"Search ...",startAdornment:e.jsx(M,{position:"start",children:e.jsx(j,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),e.jsx(U,{type:"date",sx:{ml:3},InputLabelProps:{shrink:!0},name:"dateOfBirth",defaultValue:a==null?void 0:a.dateOfBirth,onChange:s,id:"dob",label:"Date Of Birth",variant:"outlined"}),e.jsx(A,{variant:"outlined",sx:{ml:3},startIcon:e.jsx(G,{}),onClick:g,children:"Clear"})]})})}E.propTypes={filter:n.object,handleFilter:n.func,handleClear:n.func};function L({id:a,no:s,name:g,phone_no:x,gender:k,status:u,address:p,dateOfBirth:o,setOpenDialog:b,setDeleteId:i,customer_code:f,totalSpendAmount:_}){const w=D(),[T,y]=h.useState(!1),C=B=>{y(B.currentTarget)},v=()=>{w(`/users/${a}/edit`)},S=()=>{w(`/users/${a}`)};return e.jsxs(e.Fragment,{children:[e.jsxs(R,{hover:!0,tabIndex:-1,role:"checkbox",children:[e.jsx(d,{align:"center",children:s}),e.jsx(d,{align:"center",children:f}),e.jsx(d,{align:"center",children:g}),e.jsx(d,{align:"center",children:x}),e.jsx(d,{align:"center",children:k}),e.jsx(d,{align:"center",children:o}),e.jsx(d,{align:"center",children:p}),e.jsx(d,{align:"center",children:_}),e.jsxs(d,{align:"center",children:[e.jsx("div",{children:u})," "]}),e.jsx(d,{align:"right",children:e.jsx(J,{onClick:C,children:e.jsx(j,{icon:"eva:more-vertical-fill"})})})]}),e.jsxs(q,{open:!!T,anchorEl:T,onClose:()=>y(!1),anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:[e.jsxs(P,{onClick:v,children:[e.jsx(j,{icon:"eva:edit-fill",sx:{mr:2}}),"Edit"]}),e.jsxs(P,{onClick:S,children:[e.jsx(j,{icon:"ep:view",sx:{mr:2}}),"View"]})]})]})}L.propTypes={id:n.number,no:n.no,name:n.string,phone_no:n.string,gender:n.string,address:n.string,customer_code:n.string,dateOfBirth:n.string,setOpenDialog:n.func,setDeleteId:n.func,totalSpendAmount:n.bool};function $({headLabel:a}){return e.jsx(Y,{children:e.jsx(R,{children:a.map(s=>e.jsx(d,{align:s.align||"left",sx:{width:s.width,minWidth:s.minWidth},children:e.jsx(K,{hideSortIcon:!0,children:s.label})},s.id))})})}$.propTypes={headLabel:n.array};function ge(){const a=D(),[s]=Q(),g=s.get("page"),x=s.get("keyword"),k=s.get("date_of_birth"),[u,p]=h.useState([]),[o,b]=h.useState(null),[i,f]=h.useState({page:g??1,keyword:x??"",dateOfBirth:k??""}),[_,w]=h.useState(!1),[T,y]=h.useState(null);h.useState(!1);const[C,v]=h.useState(!0),S=async()=>{var l,r;const t=await O.CustomerReport(i);p((l=t==null?void 0:t.data)==null?void 0:l.data),console.log(t.data),b((r=t==null?void 0:t.data)==null?void 0:r.pagination),f({...i,keyword:x,page:g}),v(!1)};h.useEffect(()=>{S()},[]);const B=async(t,l)=>{var m,I;const r={page:l,keyword:i.keyword!=null?i.keyword:"",dateOfBirth:i.dateOfBirth};a(`/customer-report?page=${r.page}&keyword=${r.keyword}&dateOfBirth=${r.dateOfBirth}`);const c=await O.CustomerReport(r);p((m=c==null?void 0:c.data)==null?void 0:m.data),b((I=c==null?void 0:c.data)==null?void 0:I.pagination)},F=async()=>{a("/customer-report"),window.location.reload()},N=async t=>{var c,m;const l={...i,page:1,[t.target.name]:t.target.value};console.log(l),a(`/customer-report?page=${l.page}&keyword=${l.keyword}&dateOfBirth=${l.dateOfBirth}`),f({...i,[t.target.name]:t.target.value});const r=await O.CustomerReport(l);p((c=r==null?void 0:r.data)==null?void 0:c.data),b((m=r==null?void 0:r.data)==null?void 0:m.pagination)},W=()=>{console.log(i),O.CustomerReportExport(i)};return e.jsxs(X,{maxWidth:"xl",children:[e.jsxs(Z,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(ee,{variant:"h4",children:"Customer Report"}),e.jsx(A,{variant:"contained",onClick:W,color:"primary",startIcon:e.jsx(j,{icon:"eva:arrow-downward-fill"}),children:"Export"})]}),e.jsxs(te,{children:[e.jsx(E,{filter:i,handleFilter:N,handleClear:F}),C&&e.jsx(ae,{color:"secondary"}),e.jsx(ne,{children:e.jsx(se,{sx:{overflow:"unset"},children:e.jsxs(re,{sx:{minWidth:1e3},children:[e.jsx($,{headLabel:[{id:"no",label:"No",align:"center"},{id:"customer_code",label:"Customer Code",align:"center"},{id:"name",label:"Name",align:"center"},{id:"phone_no",label:"Phone Number",align:"center"},{id:"gender",label:"Gender",align:"center"},{id:"date_of_birth",label:"Date Of Birth",align:"center"},{id:"address",label:"Address",align:"center"},{id:"total_amt",label:"Total Spend Amount",align:"center"},{id:"status",label:"Status",align:"center"},{id:"action",label:"Action",align:"center"}]}),e.jsx(oe,{children:(u==null?void 0:u.length)>0?u.map((t,l)=>e.jsx(L,{no:l+1+(o==null?void 0:o.row_count)*((o==null?void 0:o.page)-1),customer_code:t.customer_code,id:t.id,name:t.name,phone_no:t.phone_no,gender:t.gender,address:t.address,dateOfBirth:t.date_of_birth,status:t.status,totalSpendAmount:t.total_spend_amount,setOpenDialog:w,setDeleteId:y,pagination:o},t.id)):!C&&e.jsx(ie,{query:i.keyword})})]})})}),o&&e.jsx(le,{sx:{float:"right",p:"20px"},count:o.total_page,page:o.page,onChange:B})]}),e.jsx(de,{position:ce,autoClose:1500})]})}function ue(){return e.jsxs(e.Fragment,{children:[e.jsx(he,{children:e.jsx("title",{children:" Juvenus POS | Customer Report "})}),e.jsx(ge,{})]})}export{ue as default};
