import{P as l,j as t,a6 as Q,B as A,a7 as D,a8 as M,I as z,y as V,a9 as K,aa as F,ab as p,am as U,ao as X,w as Y,r as i,x as Z,t as tt,S as at,T as et,C as st,z as nt,D as ot,E as lt,F as it,G as rt,H as ct,J as dt,M as ht,N as ut,A as S,W as gt}from"./index-019ce5a6.js";function _({filterName:c,onFilterName:s,handleClear:j}){return t.jsx(Q,{sx:{height:96,display:"flex",justifyContent:"space-between",p:b=>b.spacing(0,1,0,3)},children:t.jsxs(A,{sx:{display:"flex",justifyContent:"space-between",gap:"1rem"},children:[t.jsx(D,{defaultValue:c||"",onChange:s,placeholder:"Search ...",startAdornment:t.jsx(M,{position:"start",children:t.jsx(z,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})}),t.jsx(A,{sx:{alignSelf:"center"},children:t.jsx(V,{variant:"outlined",startIcon:t.jsx(K,{}),onClick:j,children:"Clear"})})]})})}_.propTypes={filterName:l.string,onFilterName:l.func,handleClear:l.func};function q({id:c,no:s,shops:j,showShopIds:b,productName:w,productCode:I,totalQty:y,isAdmin:m}){return t.jsx(t.Fragment,{children:t.jsxs(F,{hover:!0,tabIndex:-1,role:"checkbox",children:[t.jsx(p,{align:"center",children:s}),t.jsx(p,{align:"center",children:I}),t.jsx(p,{align:"center",children:w}),b.map(f=>{var g;const h=(g=j.find(x=>x.id==f))==null?void 0:g.qty;return t.jsx(p,{align:"center",children:t.jsx("span",{style:{color:h<0?"red":""},children:h||0})},f)}),m&&t.jsx(p,{align:"right",children:t.jsx("span",{style:{color:y<0?"red":""},children:y})})]})})}q.propTypes={id:l.number,no:l.number,shops:l.array,showShopIds:l.array,productCode:l.string,productName:l.string,totalQty:l.number,isAdmin:l.bool};function B({headLabel:c}){return t.jsx(U,{children:t.jsx(F,{children:c.map(s=>t.jsx(p,{align:s.align||"left",sx:{width:s.width,minWidth:s.minWidth},children:t.jsx(X,{hideSortIcon:!0,children:s.label})},s.id))})})}B.propTypes={headLabel:l.array};function xt(){const c=Y(),[s,j]=i.useState(null),[b,w]=i.useState(null),[I,y]=i.useState(null),[m]=Z(),f=m.get("page"),h=m.get("keyword"),g=m.get("status"),[x,T]=i.useState([]),[r,k]=i.useState(null),[L,C]=i.useState(""),[P,E]=i.useState(!0),[u,G]=i.useState([]),R=async()=>{var e,o,d;const a=await S.GetAvailableStockList(f,h,g),n=await S.GetShopList();T((e=a==null?void 0:a.data)==null?void 0:e.data),k((o=a==null?void 0:a.data)==null?void 0:o.pagination),C(h),E(!1),G((d=n==null?void 0:n.data)==null?void 0:d.sort((v,N)=>v.id>N.id?1:v.id<N.id?-1:0))},W=()=>{const a=JSON.parse(localStorage.getItem("user"));j(a==null?void 0:a.role_id),w(a==null?void 0:a.shop_id)};i.useEffect(()=>{R(),W()},[]),i.useEffect(()=>{y(s==1?u==null?void 0:u.map(a=>a.id):[b])},[s,u]);const $=async(a,n)=>{var o,d;c(`/available-stock-list?page=${n}&keyword=${h||""}`);const e=await S.GetAvailableStockList(n,h,g);T((o=e==null?void 0:e.data)==null?void 0:o.data),k((d=e==null?void 0:e.data)==null?void 0:d.pagination)},H=async()=>{c("/available-stock-list"),window.location.reload()},O=async a=>{var o,d;c(`/available-stock-list?page=1&keyword=${a.target.value}`),C(a.target.value);const e=await S.GetAvailableStockList(1,a.target.value,g);T((o=e==null?void 0:e.data)==null?void 0:o.data),k((d=e==null?void 0:e.data)==null?void 0:d.pagination)},J=()=>{const a=[{id:"no",label:"No",align:"center",width:"50px"},{id:"productCode",label:"Product Code",align:"center"},{id:"productName",label:"Product Name",align:"center"}],n=s==1?u==null?void 0:u.map(o=>({id:o.shop_code,label:o.name+` (${o.shop_code})`,align:"center"})):[{id:"qty",label:"Qty",align:"center"}],e=s==1?[{id:"totalQty",label:"Total",align:"right"}]:[];return a.concat(n,e)};return t.jsxs(tt,{maxWidth:"xl",children:[t.jsx(at,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:t.jsx(et,{variant:"h4",children:"Stock List Management"})}),t.jsxs(st,{children:[t.jsx(_,{filterName:L,onFilterName:O,handleClear:H}),P&&t.jsx(nt,{color:"secondary"}),t.jsx(ot,{children:t.jsx(lt,{sx:{overflow:"unset"},children:t.jsxs(it,{sx:{minWidth:1200},children:[t.jsx(B,{headLabel:J()}),t.jsx(rt,{children:(x==null?void 0:x.length)>0?x.map((a,n)=>t.jsx(q,{id:a.id,no:n+1+(r==null?void 0:r.per_page)*((r==null?void 0:r.page)-1),productName:a.product_name,productCode:a.product_code,showShopIds:I,shops:a.shops,totalQty:a.total_qty,isAdmin:s==1},n)):!P&&t.jsx(ct,{query:L,colSpan:7})})]})})}),r&&t.jsx(dt,{sx:{float:"right"},count:r.total_page,page:r.page,onChange:$})]}),t.jsx(ht,{position:ut,autoClose:1500})]})}const jt=()=>t.jsxs(t.Fragment,{children:[t.jsx(gt,{children:t.jsx("title",{children:" Juvenus POS | Stock List "})}),t.jsx(xt,{})]});export{jt as default};
