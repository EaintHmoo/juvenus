import{j as t,a6 as Dt,B as V,Y as k,Z as N,aj as A,y as z,a9 as It,P as l,am as wt,aa as H,ab as m,ao as Tt,w as J,aJ as Ft,r as o,ad as Lt,a2 as vt,I as Rt,x as kt,T as Ot,C as Gt,z as Nt,D as At,E as Bt,F as Et,G as qt,H as Wt,J as Vt,K as zt,M as Ht,N as Jt,A as p,Q as B,W as Mt}from"./index-019ce5a6.js";import{C as Qt,S as Kt}from"./Stack-4cf92a60.js";function M({filterStatus:x,filterName:f,onFilterName:$,onFilterFromDate:h,onFilterToDate:D,handleClear:F,onFilterCustomer:I,onFilterShop:O,customer:w,product:_,shop:G,onFilterProduct:L,fromCurrentDate:v,toCurrentDate:R}){return console.log(">>>>>"),console.log(w),t.jsx(Dt,{sx:{height:96,display:"flex",justifyContent:"space-between",p:r=>r.spacing(0,1,0,3)},children:t.jsxs(V,{sx:{display:"flex",justifyContent:"space-between",gap:"1rem"},children:[t.jsx(k,{type:"date",InputLabelProps:{shrink:!0},name:"from-date",defaultValue:v,onChange:h,id:"from-date",label:"From Date",variant:"outlined"}),t.jsx(k,{type:"date",InputLabelProps:{shrink:!0},name:"from-date",defaultValue:R,onChange:D,id:"from-date",label:"To Date",variant:"outlined"}),t.jsx(N,{sx:{width:"150px"},children:t.jsx(A,{disablePortal:!0,options:w,getOptionLabel:r=>r.name,onChange:(r,y)=>I(r,y),renderInput:r=>t.jsx(k,{...r,label:"Customer"})})}),t.jsx(N,{sx:{width:"150px"},children:t.jsx(A,{disablePortal:!0,options:_,getOptionLabel:r=>r.product_name,onChange:(r,y)=>L(r,y),renderInput:r=>t.jsx(k,{...r,label:"Product"})})}),t.jsx(N,{sx:{width:"150px"},children:t.jsx(A,{disablePortal:!0,options:G,getOptionLabel:r=>r.shop_name,onChange:(r,y)=>O(r,y),renderInput:r=>t.jsx(k,{...r,label:"Shop"})})}),t.jsx(V,{sx:{alignSelf:"center"},children:t.jsx(z,{variant:"outlined",sx:{ml:3},startIcon:t.jsx(It,{}),onClick:F,children:"Clear"})})]})})}M.propTypes={filterName:l.string,onFilterName:l.func,handleClear:l.func,onFilterFromDate:l.func,onFilterToDate:l.func,filterStatus:l.string,onFilterCustomer:l.func,onFilterShop:l.func,customer:l.any,product:l.any,shop:l.any,onFilterProduct:l.func,fromCurrentDate:l.any,toCurrentDate:l.any};function Q({headLabel:x}){return t.jsx(wt,{children:t.jsx(H,{children:x.map(f=>t.jsx(m,{align:f.align||"left",sx:{width:f.width,minWidth:f.minWidth},children:t.jsx(Tt,{hideSortIcon:!0,children:f.label})},f.id))})})}Q.propTypes={headLabel:l.array};function K({no:x,id:f,transaction_id:$,sale_date:h,customer:D,member_type:F,product_name:I,discount:O,price:w,qty:_,tax:G,total_amount:L,remark:v}){J(),Ft();const[R,r]=o.useState(!1),y=()=>{r(!1)};return t.jsxs(t.Fragment,{children:[t.jsxs(H,{hover:!0,tabIndex:-1,role:"checkbox",children:[t.jsx(m,{align:"center",children:f}),t.jsx(m,{align:"center",children:$??"-"}),t.jsx(m,{align:"center",children:h??"-"}),t.jsx(m,{align:"center",children:D??"-"}),t.jsx(m,{align:"center",children:F??"-"}),t.jsx(m,{align:"center",children:I??"-"}),t.jsx(m,{align:"center",children:O??"-"}),t.jsx(m,{align:"center",children:w??"-"}),t.jsx(m,{align:"center",children:_??"-"}),t.jsx(m,{align:"center",children:G??"-"}),t.jsx(m,{align:"center",children:L??"-"}),t.jsx(m,{align:"center",children:v?"FOC":"-"})]}),t.jsx(Lt,{open:!!R,anchorEl:R,onClose:()=>r(!1),anchorOrigin:{vertical:"top",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"right"},PaperProps:{sx:{width:140}},children:t.jsxs(vt,{onClick:y,sx:{mr:2},children:[t.jsx(Rt,{icon:"mdi:delete",sx:{mr:2}}),"Delete"]})})]})}K.propTypes={no:l.number,id:l.number,transaction_id:l.string,sale_date:l.string,customer:l.string,member_type:l.string,product_name:l.string,discount:l.string,price:l.string,qty:l.string,tax:l.string,total_amount:l.string,remark:l.string};function Ut(){const x=J(),[f]=kt();f.get("page"),f.get("keyword"),o.useState([]);const[$,h]=o.useState(null),[D,F]=o.useState(!0),[I,O]=o.useState(""),[w,_]=o.useState(!1),[G,L]=o.useState(!1),[v,R]=o.useState(""),[r,y]=o.useState(!1),[U,Y]=o.useState(null),[Yt,Z]=o.useState(null),[E,Zt]=o.useState(new Date().toISOString().slice(0,10));o.useState();const[Xt,X]=o.useState([]),[S,tt]=o.useState(null),[c,et]=o.useState(new Date().toISOString().slice(0,10)),[d,at]=o.useState(new Date().toISOString().slice(0,10)),[T,te]=o.useState(null),[q,P]=o.useState([]),[nt,ee]=o.useState([]),[C,st]=o.useState(null),[g,ot]=o.useState(null),[j,lt]=o.useState(null),[u,ae]=o.useState(1),[rt,it]=o.useState([]),[ct,dt]=o.useState([]),[ut,pt]=o.useState([]),W=async()=>{var n,a;const e=await p.GetSettlementLists();X((n=e==null?void 0:e.data)==null?void 0:n.data),h((a=e==null?void 0:e.data)==null?void 0:a.pagination),F(!1)},mt=async()=>{var n,a;const e=await p.GetPatientReportLists();console.log(">>>>>>><<><><><>><<><>"),console.log(e),console.log(">>>>>>><<><><><>><<><>"),P((n=e==null?void 0:e.data)==null?void 0:n.data),h((a=e==null?void 0:e.data)==null?void 0:a.pagination)},ht=async()=>{const e=await p.GetReportProducts();it(e==null?void 0:e.data)},gt=async()=>{const e=await p.GetCustomerLists();console.log(e),dt(e==null?void 0:e.data)},xt=async()=>{const e=await p.GetShops();pt(e==null?void 0:e.data)};o.useEffect(()=>{W(),mt(),ht(),gt(),xt()},[]);const ft=async(e,n)=>{var s,i;tt(n),x(`/patient-sales-report?page=${n===null?"":n}&from_date=${E===null?"":E}&to_date=${d===null?"":d}&customer_id=${T===null?"":T}&product_id=${g===null?"":g}&shop_id=${j===null?"":j}&type=${u===null?"":u}`);const a=await p.GetPatientReportLists(n);P((s=a==null?void 0:a.data)==null?void 0:s.data),h((i=a==null?void 0:a.data)==null?void 0:i.pagination)},jt=async e=>{var s,i;const n=e.target.value;et(n),x(`/patient-sales-report?page=${S===null?"":S}&from_date=${n===null?"":n}&to_date=${d===null?"":d}&customer_id=${T===null?"":T}&product_id=${g===null?"":g}&shop_id=${j===null?"":j}&type=${u===null?"":u}`);const a=await p.GetPatientReportLists("",n,"","");P((s=a==null?void 0:a.data)==null?void 0:s.data),h((i=a==null?void 0:a.data)==null?void 0:i.pagination)},yt=async e=>{var s,i;const n=e.target.value;at(n),x(`/patient-sales-report?page=${S===null?"":S}&from_date=${c===null?"":c}&to_date=${n===null?"":n}&customer_id=${T===null?"":T}&product_id=${g===null?"":g}&shop_id=${j===null?"":j}&type=${u===null?"":u}`);const a=await p.GetPatientReportLists("",c,n,"");P((s=a==null?void 0:a.data)==null?void 0:s.data),h((i=a==null?void 0:a.data)==null?void 0:i.pagination)},St=async(e,n)=>{var i,b;const a=n.id;st(n.id),x(`/patient-sales-report?page=${S===null?"":S}&from_date=${c===null?"":c}&to_date=${d===null?"":d}&customer_id=${a===null?"":a}&product_id=${g===null?"":g}&shop_id=${j===null?"":j}&type=${u===null?"":u}`);const s=await p.GetPatientReportLists("",c,d,a);P((i=s==null?void 0:s.data)==null?void 0:i.data),h((b=s==null?void 0:s.data)==null?void 0:b.pagination)},bt=async(e,n)=>{var i,b;const a=n.id;ot(a),x(`/patient-sales-report?page=${S===null?"":S}&from_date=${c===null?"":c}&to_date=${d===null?"":d}&customer_id=${C===null?"":C}&product_id=${a===null?"":a}&shop_id=${j===null?"":j}&type=${u===null?"":u}`);const s=await p.GetPatientReportLists("",c,d,C,a);P((i=s==null?void 0:s.data)==null?void 0:i.data),h((b=s==null?void 0:s.data)==null?void 0:b.pagination)},_t=async(e,n)=>{var i,b;const a=n.id;lt(a),x(`/patient-sales-report?page=${S===null?"":S}&from_date=${c===null?"":c}&to_date=${d===null?"":d}&customer_id=${C===null?"":C}&product_id=${g===null?"":g}&shop_id=${a===null?"":a}&type=${u===null?"":u}`);const s=await p.GetPatientReportLists("",c,d,C,g,a);P((i=s==null?void 0:s.data)==null?void 0:i.data),h((b=s==null?void 0:s.data)==null?void 0:b.pagination)},Pt=async()=>{x("/patient-sales-report"),window.location.reload()},Ct=async()=>{_(!1),y(!0);const e=await p.DeleteSettlement(U);e.code===200?(y(!1),B.success(e.message,{theme:"colored"}),setTimeout(()=>W(),2e3)):B.error(e.message)},$t=async()=>{try{const e=await p.DownloadPatientReport("",c,d,C,g,j,u)}catch(e){console.error("Failed to download the report:",e),B.error("Failed to download the report.")}};return t.jsxs(Qt,{maxWidth:"xl",children:[t.jsxs(Kt,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[t.jsx(Ot,{variant:"h4",children:"Patient Sales Report"}),t.jsx(z,{variant:"contained",onClick:()=>$t(),children:"Export"})]}),t.jsxs(Gt,{children:[t.jsx(M,{fromCurrentDate:c,toCurrentDate:c,filterName:I,filterStatus:v,onFilterFromDate:jt,onFilterToDate:yt,onFilterCustomer:St,onFilterShop:_t,handleClear:Pt,customer:ct,product:rt,shop:ut,transactionIds:nt,onFilterProduct:bt}),D&&t.jsx(Nt,{color:"secondary"}),t.jsx(At,{children:t.jsx(Bt,{sx:{overflow:"unset"},children:t.jsxs(Et,{sx:{minWidth:1e3},children:[t.jsx(Q,{headLabel:[{id:"id",label:"No",align:"center"},{id:"transaction_id",label:"TransactionId",align:"center"},{id:"sale_date",label:"Sale Date",align:"center"},{id:"customer",label:"Patient Name",align:"center"},{id:"member_type",label:"Member Type",align:"center"},{id:"product_name",label:"Product Name",align:"center"},{id:"discount",label:"Discount",align:"center"},{id:"price",label:"Price",align:"center"},{id:"qty",label:"Qty",align:"center"},{id:"tax",label:"Tax",align:"center"},{id:"total_amount",label:"Total Amount",align:"center"},{id:"remark",label:"Remark",align:"center"}]}),t.jsx(qt,{children:q?q.map((e,n)=>t.jsx(K,{no:e.id,id:n+1,transaction_id:e.transaction_id,sale_date:e.sale_date,customer:e.customer,member_type:e.member_type,product_name:e.product_name,discount:e.discount,price:e.price,qty:e.qty,tax:e.tax,total_amount:e.total_amount,remark:e.remark,setOpenDialog:_,setOpenApproveDialog:L,setDeleteId:Y,setUpdateId:Z},e.id)):!D&&t.jsx(Wt,{query:I})})]})})}),$&&t.jsx(Vt,{sx:{float:"right"},count:$.total_page,page:$.page,onChange:ft})]}),t.jsx(zt,{openDialog:w,setOpenDialog:_,handleDelete:Ct,disabled:r}),t.jsx(Ht,{position:Jt,autoClose:1500})]})}function oe(){return t.jsxs(t.Fragment,{children:[t.jsx(Mt,{children:t.jsx("title",{children:" Juvenus POS | Patient Report List "})}),t.jsx(Ut,{})]})}export{oe as default};
