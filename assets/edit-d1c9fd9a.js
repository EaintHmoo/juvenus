import{w as Q,a4 as H,r as n,j as e,t as J,S as $,O as z,ag as U,T as Y,C as Z,ah as o,Z as R,$ as K,a0 as V,a2 as X,ai as L,aj as ee,Y as p,ap as te,aq as _,B as se,L as ae,y as ne,a3 as le,M as ie,N as oe,A as h,Q as w,W as re}from"./index-019ce5a6.js";import"./table-head-98595357.js";import"./approve-dialog-1c59e89c.js";import{R as de,a as A}from"./RadioGroup-8a0afae4.js";const ce=()=>{const E=Q(),{id:b}=H(),[I,T]=n.useState([]),[q,F]=n.useState([]),[B,G]=n.useState(null),[r,y]=n.useState(""),[d,S]=n.useState(""),[c,g]=n.useState(""),[u,v]=n.useState(""),[m,f]=n.useState(""),[P,k]=n.useState(""),[D,x]=n.useState(!1),[t,O]=n.useState(),W=async()=>{var C;const s=await h.GetProductList(),l=await h.GetShopList(),i=await h.GetStockAdjustment(b),a=i==null?void 0:i.data;T((C=s==null?void 0:s.data)==null?void 0:C.filter(j=>(j==null?void 0:j.is_stock_control)==1)),F(l==null?void 0:l.data),y(a==null?void 0:a.shop_id),S({label:a==null?void 0:a.product_name,id:a==null?void 0:a.product_id}),g(a==null?void 0:a.qty),v(a==null?void 0:a.type),f(a==null?void 0:a.responsible_person),k(a==null?void 0:a.reason)},M=async s=>{s.preventDefault(),x(!0);const l={shop_id:r,product_id:d.id,qty:c,type:u,responsible_person:m,reason:P};if(d&&r&&c&&m&&u){const i=await h.EditStockAdjustment(l,b);i.code===200?(w.success(i.message,{theme:"colored"}),setTimeout(()=>E("/stock-adjustments"),2e3)):(x(!1),w.error(i.message))}else O({shop:r==="",product:d==="",qty:c==="",responsiblePerson:m==="",type:u===""}),x(!1)},N=()=>{const s=JSON.parse(localStorage.getItem("user"));G(s==null?void 0:s.role_id)};return n.useEffect(()=>{W(),N()},[]),e.jsxs(J,{maxWidth:"xl",children:[e.jsx($,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:e.jsxs(z,{"aria-label":"breadcrumb",children:[e.jsx(U,{variant:"h4",underline:"hover",color:"inherit",href:"/stock-adjustments",children:"Stock Adjustment Management"}),e.jsx(Y,{variant:"h4",children:"Edit Stock Adjustment"})]})}),e.jsx(Z,{sx:{padding:"1rem",minHeight:"50vh"},children:e.jsxs("form",{onSubmit:M,children:[e.jsxs(o,{container:!0,spacing:2,children:[e.jsx(o,{item:!0,xs:6,md:6,sm:12,children:e.jsxs(R,{fullWidth:!0,error:t==null?void 0:t.shop,children:[e.jsx(K,{id:"demo-simple-select-label",children:"Shop"}),e.jsx(V,{labelId:"demo-simple-select-label",id:"demo-simple-select",value:r,label:"Shop",inputProps:{readOnly:B!==1},onChange:s=>{y(s.target.value)},children:q.map(s=>e.jsx(X,{value:s.id,children:s.shop_code},s.id))}),e.jsx(L,{children:t!=null&&t.shop?"Select Shop!":" "})]})}),e.jsx(o,{item:!0,xs:6,md:6,sm:12,children:e.jsx(ee,{freeSolo:!0,id:"product-list",value:d||null,options:I.map(s=>({label:s.product_name,id:s.id})),onChange:(s,l)=>S(l),renderInput:s=>e.jsx(p,{...s,label:"Products",error:t==null?void 0:t.product,helperText:t!=null&&t.product?"Add Product!":""})})}),e.jsx(o,{item:!0,xs:6,md:6,sm:12,children:e.jsx(p,{id:"qty",label:"Quantity",type:"number",value:c??"",onChange:s=>g(s.target.value),sx:{width:"100%"},error:t==null?void 0:t.qty,helperText:t!=null&&t.qty?"Enter qty":""})}),e.jsx(o,{item:!0,xs:6,md:6,sm:12,children:e.jsxs(R,{fullWidth:!0,error:t==null?void 0:t.type,children:[e.jsx(te,{id:"type-label",children:"Type"}),e.jsxs(de,{row:!0,"aria-labelledby":"type-label",name:"type",value:u,onChange:s=>{v(s.target.value)},children:[e.jsx(_,{value:"+",control:e.jsx(A,{}),label:"+"}),e.jsx(_,{value:"-",control:e.jsx(A,{}),label:"-"})]}),e.jsx(L,{children:t!=null&&t.type?"Select type!":" "})]})}),e.jsx(o,{item:!0,xs:6,md:6,sm:12,children:e.jsx(p,{id:"responsible-person",label:"Responsible Person",value:m??"",onChange:s=>f(s.target.value),sx:{width:"100%"},error:t==null?void 0:t.responsiblePerson,helperText:t!=null&&t.responsiblePerson?"Enter responsible person":""})}),e.jsx(o,{item:!0,xs:6,md:6,sm:12,children:e.jsx(p,{id:"reason",label:"Reason",value:P??"",onChange:s=>k(s.target.value),sx:{width:"100%"},multiline:!0})})]}),e.jsxs(se,{sx:{pb:3,display:"flex",mt:2,float:"right"},children:[e.jsx(ae,{underline:"hover",color:"primary",to:"/stock-adjustments",children:e.jsx(ne,{variant:"outlined",color:"primary",sx:{borderRadius:1,marginRight:1},children:"Cancel"})}),e.jsx(le,{type:"submit",size:"medium",variant:"contained",sx:{borderRadius:1},loading:D,children:"Update"})]})]})}),e.jsx(ie,{position:oe,autoClose:1500})]})},xe=()=>e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx("title",{children:" Juvenus POS | Stock Adjustment "})}),e.jsx(ce,{})]});export{xe as default};
